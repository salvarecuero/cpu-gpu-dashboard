[Rainmeter]
Update=1000
AccurateText=1
DynamicWindowSize=1

[Metadata]
Name=CPU/GPU Dashboard
Author=CPU GPU Dashboard
Version=1.0.0
Information=Displays CPU and GPU temperature and usage from HWiNFO64

; ==========================================
; INCLUDES
; ==========================================
@IncludeVariables=#@#Variables.inc
@IncludeStyles=#@#Styles.inc

; ==========================================
; VARIABLES
; ==========================================
[Variables]
RingSize=90
RingInner=38
RingOuter=45

; ==========================================
; MEASURES - CONFIGURATION CHECK
; ==========================================

[MeasureCheckConfig]
Measure=Calc
Formula=#IsConfigured#
IfCondition=(MeasureCheckConfig = 0)
IfTrueAction=[!ActivateConfig "CPUGPUDashboard\Setup" "Setup.ini"][!DeactivateConfig "#CURRENTCONFIG#"]
DynamicVariables=1

; ==========================================
; MEASURES - CPU DATA
; ==========================================

[MeasureCPUTemp]
Measure=Registry
RegHKey=#RegHKey#
RegKey=SOFTWARE\HWiNFO64\VSB
RegValue=ValueRaw#CPUTempIndex#
IfMatch=^$
IfMatchAction=[!ShowMeterGroup ErrorGroup][!HideMeterGroup DashboardGroup][!Redraw]
IfNotMatchAction=[!HideMeterGroup ErrorGroup][!ShowMeterGroup DashboardGroup][!Redraw]
DynamicVariables=1

[MeasureCPUTempPercent]
Measure=Calc
Formula=Clamp(MeasureCPUTemp, 0, 100)
MinValue=0
MaxValue=100
DynamicVariables=1

[MeasureCPUUsage]
Measure=Registry
RegHKey=#RegHKey#
RegKey=SOFTWARE\HWiNFO64\VSB
RegValue=ValueRaw#CPUUsageIndex#
DynamicVariables=1

[MeasureCPUUsagePercent]
Measure=Calc
Formula=Clamp(MeasureCPUUsage, 0, 100)
MinValue=0
MaxValue=100
DynamicVariables=1

; ==========================================
; MEASURES - GPU DATA
; ==========================================

[MeasureGPUTemp]
Measure=Registry
RegHKey=#RegHKey#
RegKey=SOFTWARE\HWiNFO64\VSB
RegValue=ValueRaw#GPUTempIndex#
DynamicVariables=1

[MeasureGPUTempPercent]
Measure=Calc
Formula=Clamp(MeasureGPUTemp, 0, 100)
MinValue=0
MaxValue=100
DynamicVariables=1

[MeasureGPUUsage]
Measure=Registry
RegHKey=#RegHKey#
RegKey=SOFTWARE\HWiNFO64\VSB
RegValue=ValueRaw#GPUUsageIndex#
DynamicVariables=1

[MeasureGPUUsagePercent]
Measure=Calc
Formula=Clamp(MeasureGPUUsage, 0, 100)
MinValue=0
MaxValue=100
DynamicVariables=1

; ==========================================
; METERS - CPU ROW
; ==========================================

[MeterCPULabel]
Meter=String
MeterStyle=StyleLabelClickable
X=160
Y=112
Text=CPU
Group=DashboardGroup

; --- CPU Temperature Ring ---
[MeterCPUTempRingBg]
Meter=Roundline
X=65
Y=40
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorRingBg#
Solid=1
AntiAlias=1
Group=DashboardGroup

[MeterCPUTempRingFg]
Meter=Roundline
MeasureName=MeasureCPUTempPercent
X=65
Y=40
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorGood#
Solid=1
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

[MeasureCPUTempColor]
Measure=Calc
Formula=MeasureCPUTemp
IfCondition=(MeasureCPUTempColor <= 45)
IfTrueAction=[!SetOption MeterCPUTempRingFg LineColor "#ColorGood#"][!UpdateMeter MeterCPUTempRingFg][!Redraw]
IfCondition2=(MeasureCPUTempColor > 45) && (MeasureCPUTempColor <= 70)
IfTrueAction2=[!SetOption MeterCPUTempRingFg LineColor "#ColorWarning#"][!UpdateMeter MeterCPUTempRingFg][!Redraw]
IfCondition3=(MeasureCPUTempColor > 70)
IfTrueAction3=[!SetOption MeterCPUTempRingFg LineColor "#ColorDanger#"][!UpdateMeter MeterCPUTempRingFg][!Redraw]
DynamicVariables=1

[MeterCPUTempValue]
Meter=String
MeasureName=MeasureCPUTemp
X=110
Y=98
StringAlign=CenterCenter
FontFace=Segoe UI
FontSize=13
FontWeight=600
FontColor=#ColorText#
Text=%1[\x00B0]C
NumOfDecimals=0
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

; --- CPU Usage Ring ---
[MeterCPUUsageRingBg]
Meter=Roundline
X=165
Y=40
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorRingBg#
Solid=1
AntiAlias=1
Group=DashboardGroup

[MeterCPUUsageRingFg]
Meter=Roundline
MeasureName=MeasureCPUUsagePercent
X=165
Y=40
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorGood#
Solid=1
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

[MeasureCPUUsageColor]
Measure=Calc
Formula=MeasureCPUUsage
IfCondition=(MeasureCPUUsageColor <= 50)
IfTrueAction=[!SetOption MeterCPUUsageRingFg LineColor "#ColorGood#"][!UpdateMeter MeterCPUUsageRingFg][!Redraw]
IfCondition2=(MeasureCPUUsageColor > 50) && (MeasureCPUUsageColor <= 80)
IfTrueAction2=[!SetOption MeterCPUUsageRingFg LineColor "#ColorWarning#"][!UpdateMeter MeterCPUUsageRingFg][!Redraw]
IfCondition3=(MeasureCPUUsageColor > 80)
IfTrueAction3=[!SetOption MeterCPUUsageRingFg LineColor "#ColorDanger#"][!UpdateMeter MeterCPUUsageRingFg][!Redraw]
DynamicVariables=1

[MeterCPUUsageValue]
Meter=String
MeasureName=MeasureCPUUsage
X=210
Y=98
StringAlign=CenterCenter
FontFace=Segoe UI
FontSize=13
FontWeight=600
FontColor=#ColorText#
Text=%1%
NumOfDecimals=0
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

; ==========================================
; METERS - GPU ROW
; ==========================================

[MeterGPULabel]
Meter=String
MeterStyle=StyleLabelClickable
X=160
Y=210
Text=GPU
Group=DashboardGroup

; --- GPU Temperature Ring ---
[MeterGPUTempRingBg]
Meter=Roundline
X=65
Y=140
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorRingBg#
Solid=1
AntiAlias=1
Group=DashboardGroup

[MeterGPUTempRingFg]
Meter=Roundline
MeasureName=MeasureGPUTempPercent
X=65
Y=140
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorGood#
Solid=1
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

[MeasureGPUTempColor]
Measure=Calc
Formula=MeasureGPUTemp
IfCondition=(MeasureGPUTempColor <= 45)
IfTrueAction=[!SetOption MeterGPUTempRingFg LineColor "#ColorGood#"][!UpdateMeter MeterGPUTempRingFg][!Redraw]
IfCondition2=(MeasureGPUTempColor > 45) && (MeasureGPUTempColor <= 70)
IfTrueAction2=[!SetOption MeterGPUTempRingFg LineColor "#ColorWarning#"][!UpdateMeter MeterGPUTempRingFg][!Redraw]
IfCondition3=(MeasureGPUTempColor > 70)
IfTrueAction3=[!SetOption MeterGPUTempRingFg LineColor "#ColorDanger#"][!UpdateMeter MeterGPUTempRingFg][!Redraw]
DynamicVariables=1

[MeterGPUTempValue]
Meter=String
MeasureName=MeasureGPUTemp
X=110
Y=196
StringAlign=CenterCenter
FontFace=Segoe UI
FontSize=13
FontWeight=600
FontColor=#ColorText#
Text=%1[\x00B0]C
NumOfDecimals=0
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

; --- GPU Usage Ring ---
[MeterGPUUsageRingBg]
Meter=Roundline
X=165
Y=140
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorRingBg#
Solid=1
AntiAlias=1
Group=DashboardGroup

[MeterGPUUsageRingFg]
Meter=Roundline
MeasureName=MeasureGPUUsagePercent
X=165
Y=140
W=#RingSize#
H=#RingSize#
StartAngle=(Rad(180))
RotationAngle=(Rad(180))
LineStart=#RingInner#
LineLength=#RingOuter#
LineColor=#ColorGood#
Solid=1
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

[MeasureGPUUsageColor]
Measure=Calc
Formula=MeasureGPUUsage
IfCondition=(MeasureGPUUsageColor <= 50)
IfTrueAction=[!SetOption MeterGPUUsageRingFg LineColor "#ColorGood#"][!UpdateMeter MeterGPUUsageRingFg][!Redraw]
IfCondition2=(MeasureGPUUsageColor > 50) && (MeasureGPUUsageColor <= 80)
IfTrueAction2=[!SetOption MeterGPUUsageRingFg LineColor "#ColorWarning#"][!UpdateMeter MeterGPUUsageRingFg][!Redraw]
IfCondition3=(MeasureGPUUsageColor > 80)
IfTrueAction3=[!SetOption MeterGPUUsageRingFg LineColor "#ColorDanger#"][!UpdateMeter MeterGPUUsageRingFg][!Redraw]
DynamicVariables=1

[MeterGPUUsageValue]
Meter=String
MeasureName=MeasureGPUUsage
X=210
Y=196
StringAlign=CenterCenter
FontFace=Segoe UI
FontSize=13
FontWeight=600
FontColor=#ColorText#
Text=%1%
NumOfDecimals=0
AntiAlias=1
DynamicVariables=1
Group=DashboardGroup

; ==========================================
; METERS - ERROR GROUP
; ==========================================

[MeterErrorBackground]
Meter=Shape
Shape=Rectangle 0,0,#SkinWidth#,#SkinHeight#,#CornerRadius# | Fill Color #ColorBackground# | StrokeWidth 0
Group=ErrorGroup
Hidden=1

[MeterErrorTitle]
Meter=String
MeterStyle=StyleTitle
X=(#SkinWidth#/2)
Y=30
StringAlign=Center
Text=Sensor Error
FontColor=#ColorDanger#
Group=ErrorGroup
Hidden=1

[MeterErrorText]
Meter=String
MeterStyle=StyleInstructions
X=(#SkinWidth#/2)
Y=15R
W=(#SkinWidth# - 40)
StringAlign=Center
Text=HWiNFO64 sensors not found. Ensure HWiNFO is running with Gadget reporting enabled.
Group=ErrorGroup
Hidden=1

[MeterReconfigureButton]
Meter=String
MeterStyle=StyleButtonPrimary
X=(#SkinWidth#/2 - 50)
Y=20R
Text=Reconfigure
LeftMouseUpAction=[!WriteKeyValue Variables IsConfigured "0" "#@#Variables.inc"][!ActivateConfig "CPUGPUDashboard\Setup" "Setup.ini"][!DeactivateConfig "#CURRENTCONFIG#"]
Group=ErrorGroup
Hidden=1
